<html>
  <head>
    <title>Parque de Diversiones</title>
    <style>
      canvas {
        width: 100%;
        height: 100%;
      }
      body {
        margin: 0;
      }
    </style>
  </head>
  <body>
    <script src="three.min.js"></script>
    <script>
      window.addEventListener("keydown", doKeyDown, true);
      // agregamos el "listener" para "escuchar" los eventos del teclado

      var zpos = 50;
      var xpos = 0;
      var ypos = 0;
      var x = 0.0;
      var y = 0.0;
      var z = 0.0;
      var xx = 0.0;
      var yy = 0.0;
      var zz = 0.0;
      var angle = 0;
      var rotEntiereArm = 0;
      var rotXEntiereArm = 0;
      var rotXForeArm = 0;
      var openFinger = 1.3;
      var openFinger2 = -1.3;
      var rotHand = 0;

      function doKeyDown(evt) {

        switch (evt.keyCode) {

          //Camera
          case 38 /* Up arrow was pressed */:
            zpos= (zpos-(0.8*Math.cos(ypos))); 
            xpos= (xpos-(0.8*Math.sin(ypos)));
            break;
          case 40 /* Down arrow was pressed */:
            zpos= (zpos+(0.8*Math.cos(ypos)));
            xpos= (xpos+(0.8*Math.sin(ypos)));
            break;
          case 37 /* Left arrow was pressed */:
            ypos += 0.05;
            break;
          case 39 /* Right arrow was pressed */:
            ypos -= 0.05;
            break;

          //Camera WASD
          case 87:  /* W was pressed */
            //zpos= (zpos-(0.8*Math.cos(ypos))); 
            //xpos= (xpos-(0.8*Math.sin(ypos)));   
            camera.position.y += 0.5;                       
            break;
          case 83:  /* S was pressed */
            //zpos= (zpos+(0.8*Math.cos(ypos)));
            //xpos= (xpos+(0.8*Math.sin(ypos)));
            camera.position.y -= 0.5;                                                
            break;
          case 68:  /* D was pressed */
            ypos -= 0.05;         
            break;
          case 65:  /* A was pressed */
            ypos += 0.05;         
            break;

          //Entiere Arm
          case 84:  /* T was pressed */
            rotEntiereArm += 0.1;         
            break; 
          case 71:  /* G was pressed */
            rotEntiereArm -= 0.1;         
            break; 
          case 82:  /* R was pressed */
           if(rotXEntiereArm<0.9)
            rotXEntiereArm += 0.1;         
            break; 
          case 70:  /* F was pressed */
          if(rotXEntiereArm>-0.9)
            rotXEntiereArm -= 0.1;         
            break; 
          case 89:  /* Y was pressed */
             rotXForeArm += (0.05);         
            break; 
          case 72:  /* H was pressed */
            rotXForeArm -= (0.05);         
            break; 
          //Manita
          case 73://U
            if(openFinger<1.5 && openFinger2>-1.5){
              openFinger += 0.1;
              openFinger2 -= 0.1;
            }
            break;
          
          case 75://J
          if(openFinger>0.7 && openFinger2<-0.7){
              openFinger -= 0.1;
              openFinger2 += 0.1;
            }
            break;
          case 85://I
          if(rotHand<1.5){
            rotHand += 0.1;
          }
          break;
          case 74://K
          if(rotHand>1.5){
            rotHand -= 0.1;
          }
        }
      }

      // three basic components of a scene
      var scene = new THREE.Scene();
      var camera = new THREE.PerspectiveCamera(
        75,
        window.innerWidth / window.innerHeight,
        0.01,
        1000
      );
      var renderer = new THREE.WebGLRenderer();

      // create a new geometry
      var geom = new THREE.Geometry();
      var floor = new THREE.BoxGeometry( 300, 10, 300 );
      var baseStructure = new THREE.CylinderGeometry(5,5,100,100);
      var tuboAcostado = new THREE.CylinderGeometry(10,10,60,100);
      var tuboRueda = new THREE.CylinderGeometry(2,2,30,30);

      // create a Lambert material
      var LambertMaterial = new THREE.MeshLambertMaterial({
        color: 0xc0c0c0
        });

      // create a wireframe material
      var meshMaterial = new THREE.MeshBasicMaterial({
        color: 0xC0C0C0,
        wireframe: true
      });

      var pasto = new THREE.MeshLambertMaterial ({map: THREE.ImageUtils.loadTexture("pasto.jpg")});
      var metal = new THREE.MeshLambertMaterial ({map: THREE.ImageUtils.loadTexture("metal.jpg")});
      var blackMetal = new THREE.MeshLambertMaterial ({map: THREE.ImageUtils.loadTexture("blackmetal.jpg")});

      var base = new THREE.Mesh(floor, pasto);

      var tubo = new THREE.Mesh(baseStructure, metal);
      var tubo2 = new THREE.Mesh(baseStructure, metal);
      var tubo3 = new THREE.Mesh(tuboAcostado, metal); 
      var tubo4 = new THREE.Mesh(baseStructure, metal);
      var tubo5 = new THREE.Mesh(baseStructure, metal);

      var tubo6 = new THREE.Mesh(tuboRueda, blackMetal);
      var tubo7 = new THREE.Mesh(tuboRueda, blackMetal);
      var tubo8 = new THREE.Mesh(tuboRueda, blackMetal);
      var tubo9 = new THREE.Mesh(tuboRueda, blackMetal);

      var tubo10 = new THREE.Mesh(tuboRueda, blackMetal);
      var tubo11 = new THREE.Mesh(tuboRueda, blackMetal);
      var tubo12 = new THREE.Mesh(tuboRueda, blackMetal);
      var tubo13 = new THREE.Mesh(tuboRueda, blackMetal);

      var tubo14 = new THREE.Mesh(tuboRueda, blackMetal);
      var tubo15 = new THREE.Mesh(tuboRueda, blackMetal);
      var tubo16 = new THREE.Mesh(tuboRueda, blackMetal);
      var tubo17 = new THREE.Mesh(tuboRueda, blackMetal);

      // add the group to the scene
      renderer.setSize(window.innerWidth, window.innerHeight);
      document.body.appendChild(renderer.domElement);

      // create some point lights
      var pointLight = new THREE.PointLight(0xffffff);
      var pointLight2 = new THREE.PointLight(0xffffff);

      // set its position
      pointLight.position.x = 10;
      pointLight.position.y = 50;
      pointLight.position.z = 130;

      base.position.y=-10; base.position.x = 0; base.position.z = 15;

        tubo.rotation.z = 60;
        tubo2.rotation.z = -60;
        tubo2.position.x = -42;
        tubo3.rotation.x = 190;
        tubo3.position.y = 50;
        tubo3.position.x = -22;
        tubo3.position.z = -25;
        tubo4.rotation.z = 60;
        tubo4.position.z = -48;
        tubo5.position.z = -48;
        tubo5.rotation.z = -60;
        tubo5.position.x = -42;

        tubo6.position.y=40; tubo6.position.x = 0; tubo6.position.z = -18;
        tubo7.position.y=40; tubo7.position.x = 0; tubo7.position.z = -31; 
        tubo6.rotation.z=1;
        tubo7.rotation.z=1; 

        tubo8.position.y=60; tubo8.position.x = 0; tubo8.position.z = -18;
        tubo9.position.y=60; tubo9.position.x = 0; tubo9.position.z = -31; 
        tubo8.rotation.z=2;
        tubo9.rotation.z=2;

        tubo10.position.y=40; tubo10.position.x = -40; tubo10.position.z = -18;
        tubo11.position.y=40; tubo11.position.x = -40; tubo11.position.z = -31; 
        tubo10.rotation.z=-1;
        tubo11.rotation.z=-1; 

        tubo12.position.y=60; tubo12.position.x = -40; tubo12.position.z = -18;
        tubo13.position.y=60; tubo13.position.x = -40; tubo13.position.z = -31; 
        tubo12.rotation.z=-2;
        tubo13.rotation.z=-2;           
        
        tubo14.position.y=70; tubo14.position.x = -20; tubo14.position.z = -18;
        tubo15.position.y=70; tubo15.position.x = -20; tubo15.position.z = -31; 

        tubo16.position.y=25; tubo16.position.x = -20; tubo16.position.z = -18;
        tubo17.position.y=25; tubo17.position.x = -20; tubo17.position.z = -31; 
      
      // add to the scene
      scene.add(pointLight);

      // set its position
      pointLight2.position.x = 10;
      pointLight2.position.y = -50;
      pointLight2.position.z = -130;

      estructura = new THREE.Object3D();
      estructura.add(tubo);
      estructura.add(tubo2);
      estructura.add(tubo3);
      estructura.add(tubo4);
      estructura.add(tubo5);
      estructura.position.y=35;

      aro = new THREE.Object3D();
      aro.add(tubo6);
      aro.add(tubo7);
      aro.add(tubo8);
      aro.add(tubo9);
      aro.add(tubo10);
      aro.add(tubo11);
      aro.add(tubo12);
      aro.add(tubo13);
      aro.add(tubo14);
      aro.add(tubo15);
      aro.add(tubo16);
      aro.add(tubo17);
      aro.position.y+=35;

      // add to the scene
      scene.add(pointLight2);
      scene.add(base); 
      scene.add(estructura);
      scene.add(aro);

      // set the background color
      renderer.setClearColor(0x2271B3, 1);

      var render = function() {
        requestAnimationFrame(render);
        camera.position.z = zpos; 
        camera.position.x = xpos;
        camera.rotation.y = ypos; 

        tubo3.rotation.y += 0.01;
        //  aro.rotation.z +=0.01;

        renderer.render(scene, camera);
      };
      render();
    </script>
  </body>
</html>